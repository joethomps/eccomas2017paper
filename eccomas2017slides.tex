\documentclass{beamer}
 
\mode<presentation>
{
  \usetheme{Boadilla}
  %\usetheme{default}
  %\usetheme{Darmstadt}
  \setbeamercovered{transparent}
  % or whatever (possibly just delete it)
}

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{times}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amsfonts,amssymb,amsthm,amsbsy,amsmath}
\usepackage{pgfplots}
\pgfplotsset{compat=1.11} 
\usepackage{subfigure}
\usetikzlibrary{shapes,arrows,scopes,patterns,decorations.pathreplacing}
\usepackage[backend=biber, style=authoryear, url=false, doi=false, isbn=false]{biblatex}
\bibliography{eccomas_2017}
\usefonttheme{professionalfonts}

\title[Equivalent Mass-Spring Models]{Equivalent Mass-Spring Models of Multibody Spacecraft for the Application of Wave-based Control}

\author{Joseph Thompson} %\and W. J.~O'Connor}

\institute[UCD, Ireland]{University College Dublin, Ireland}

\date[ECCOMAS MBD 2017] % (optional, should be abbreviation of conference name)
{8th Eccomas Thematic Conference on Multibody Dynamics \\ \vspace{8pt} \small{Czech Technical University, Prague, 19-22 June, 2017}}

\subject{Multibody Dynamics}

\pgfdeclareimage[height=1cm]{university-logo}{ucd_brandmark_colour}
\logo{\pgfuseimage{university-logo}}

\begin{document}

\begin{frame}
  \titlepage
\end{frame}
\begin{frame}{Outline}
  \tableofcontents
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%-------MOTIVATION--------%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Motivation}

\subsection{Wave-based Modelling and Control of Lumped Flexible Systems}
\begin{frame}{Underactuated control problem}
\begin{center}
\includegraphics[]{images/lumped_system.pdf}
\end{center}
\begin{itemize}
\item Classic underactuated control problem
\item Rest-to-rest motion
\item Combine gross motion control and active vibration damping
\end{itemize}
\begin{center}
\includegraphics[width=0.85\textwidth]{images/under_actuated_systems.png}
\end{center}
\end{frame}

\begin{frame}{Wave-based Modelling of Lumped Systems}
\begin{itemize}
\item Novel approach - wave based model \footcite{OConnor2011}
\item Decompose the system into two components travelling into and out of the system
\item Wave-transfer function
\item Uniform vs. non-uniform
\end{itemize}
\includegraphics[width=\textwidth]{images/series_model_tf_unif.pdf}
\end{frame}

\begin{frame}{Wave-based Control System}
\input{graphics/WBC-nunif-pres.tex}
\begin{itemize}
\item Strategy:
	\begin{enumerate} %%%% copy from eccomas pres
	\item Actuator launches a wave into the system which travels to the right 
	\item Wave reaches the system boundary and is reflected back leftwards
	\item Returning wave is measured and absorbed at the actuator
	\end{enumerate}
\item Intuitive way to do control, respects the delay inherent in the system - many desirable properties
\item Successfully applied to rectilinear mass-spring systems \footcite{OConnor1998}
\item Objective: extend to a wider class of systems (multi-body spacecraft)
\end{itemize}
\end{frame}

\subsection{Attitude Control of Multibody Spacecraft}
\begin{frame}{Spacecraft Modelled as Multibody Systems}
\begin{itemize}
\item How similar are these to the mass spring systems shown above
\item Choice of actuators: TVC, thrusters, momentum wheels
\item Choice of sensor position: IMU, gyroscopes, accelerometers
\end{itemize}body spacecraft
%%%% images of multi-body spacecraft
\begin{columns}
\column{0.5\textwidth}
\begin{figure}
\includegraphics[width=\textwidth]{images/satellite.jpg}
\end{figure}
\column{0.5\textwidth}
\begin{figure}
\includegraphics[width=\textwidth]{images/rocket3.pdf}
\end{figure}
\end{columns}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%-------PROBLEM STATEMENT--------%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Problem Statement}
\begin{frame}{Problem Statement}
Given a SISO (single-input single-output) undamped system described by:
\begin{equation}
\ddot{\mathbf{q}}(t) + \Lambda\mathbf{q}(t) = \mathbf{b}u(t)
\label{eq:modal1}
\end{equation}
\begin{equation}
y(t) = \mathbf{c}^T \mathbf{q}(t)
\label{eq:modal2}
\end{equation}
$$
\Lambda = \begin{bmatrix}
\lambda_1  &  0 & \cdots & 0 \\
0 & \lambda_2  & \ddots & 0 \\
\vdots & \ddots & \ddots & \vdots \\
0 & 0 & \cdots & \lambda_n \end{bmatrix}
,\quad \mathbf{b} = \begin{bmatrix} b_1 \\ b_2 \\ \vdots \\ b_n \end{bmatrix}
,\quad \mathbf{c} = \begin{bmatrix} c_1 \\ c_2 \\ \vdots \\ c_n \end{bmatrix}
\label{eq:modal3}
$$
where $u(t)$ is the input and $y(t)$ is the output,
\begin{enumerate}
\item Under what conditions can this system be transformed into a mass-spring string where the input is a force on first mass and output is the position of the first mass.
\item If so, how can the equivalent system (mass and stiffness values) be calculated?
\end{enumerate}
\end{frame}

\begin{frame}{Problem Statement}
In other words: Can we find a coordinate transformation $\mathbf{x} = P \mathbf{q}$, from $\mathbf{q}$ to a new coordinate system $\mathbf{x}$
such that:
\begin{equation}
M\ddot{\mathbf{x}}(t) + K\mathbf{x}(t) = \mathbf{\hat{b}}u(t)
\label{eq:ms1}
\end{equation}
\begin{equation}
y(t) = \mathbf{\hat{c}}^T \mathbf{x}(t)
\label{eq:ms2}
\end{equation}
\footnotesize{
$$
M = \begin{bmatrix}
m_1  &  0 & \cdots & 0 \\
0 & m_2  & \ddots & 0 \\
\vdots & \ddots & \ddots & \vdots \\
0 & 0 & \cdots & m_n \end{bmatrix}
, \quad
K = \begin{bmatrix}
k_0+k_1  &  -k_1  & \cdots & 0 \\
-k_1 & k_1+k_2   & \ddots & 0 \\
\vdots & \ddots & \ddots & -k_{n-1} \\
0 & 0  & -k_{n-1} &  k_{n-1} + k_n \end{bmatrix}
$$
$$
\mathbf{\hat{b}} = \begin{bmatrix} 1 & 0 & \cdots & 0 \end{bmatrix}^T
,\quad \mathbf{\hat{c}} = \begin{bmatrix} 1 & 0 & \cdots & 0 \end{bmatrix}^T
\label{eq:ms3}
$$
}
\end{frame}
%%%%% image of mass spring required form

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%-------METHODS--------%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Methods}
\subsection{Inverse Eigenvalue Problem for Jacobi Matrices}
\begin{frame}{Scaling of input and output vectors}
First consider the transformation $\mathbf{v} = A \mathbf{q}$
$$A = \begin{bmatrix}
a_1  &  0 & \cdots & 0 \\
0 & a_2  & \ddots & 0 \\
\vdots & \ddots & \ddots & \vdots \\
0 & 0 & \cdots & a_n \end{bmatrix}$$
Scales the $\mathbf{b}$ and $\mathbf{c}$ vectors without affecting $\Lambda$
\begin{equation}
\ddot{\mathbf{v}}(t) +  \Lambda \mathbf{v}(t) =  A^{-1} \mathbf{b}u(t) =  \begin{bmatrix} b_1/a_1 \\ b_2/a_2 \\ \vdots \\ b_n/a_n  \end{bmatrix} u(t)
\label{eq:scaled1}
\end{equation}
\begin{equation}
y(t) = \mathbf{c}^T  A \mathbf{v}(t) = \begin{bmatrix} a_1 c_1 & a_2 c_2 & \cdots & a_n c_n \end{bmatrix} \mathbf{v}(t)
\label{eq:scaled2}
\end{equation}
\end{frame}

\begin{frame}{Inverse eigenvalue problem for Jacobi matrix}
Gladwell \cite{gladwell1986inverse} investigates inverse eigenvalue problems for Jacobi matrices which are defined as follows:
a Jacobi matrix is a positive semi-definite symmetric tri-diagonal matrix with strictly negative co-diagonal.
We make use of the following theorem for Jacobi matrices:

There is a unique Jacobi matrix $\mathbf{J}$ having specified eigenvalues $(\lambda_i)_1^n$, where
\begin{equation}
0 \leq \lambda_1<\lambda_2< \cdots <\lambda_n
\label{eq:lambda}
\end{equation}
and with normalised eigenvectors $(\mathbf{u}_i)_1^n$  having non-zero specified values $(u_{1i})_1^n$ of their first components.
Recall that $\mathbf{u}_i = \begin{bmatrix} u_{1i} &  u_{2i} & \cdots & u_{ni} \end{bmatrix}^T$.

%To simplify notation let $U$ be the orthogonal matrix whose columns are the eigenvectors $\mathbf{u}_i$ of the Jacobi matrix $J$ and let $X$ be the transpose of $U$ with columns $\mathbf{x}_i$.
%Then the theorem says that for a given $\Lambda$ and $\mathbf{x_1}$ (the first column of $X$) there is a unique Jacobi matrix $J$ and orthogonal matrix $U$.
%The Lanczos algorithm may be used to calculate the matrices $J$ and $U$ ($X^T$) for a given $\Lambda$ and $\mathbf{x_1}$ such that 
%\begin{equation}
%J U = U \Lambda
%\end{equation}
%This may be rewritten in terms of $X$ as
%\begin{equation}
%X J = \Lambda X
%\label{eq:lanczos}
%\end{equation}
%The Lanczos algorithm works as follows.
%Eq. \ref{eq:lanczos} may be expanded as
%\begin{equation}
%\begin{bmatrix} \mathbf{x_1} &  \mathbf{x_2} & \cdots & \mathbf{x_n} \end{bmatrix}
%\begin{bmatrix} d_1  &  -e_1 & 0 & \cdots & 0 \\
%-e_1 & d_2  & -e_2 & \ddots & 0 \\
%0 & -e_2 & \ddots & \ddots & \vdots \\
%\vdots & \ddots & \ddots & d_{n-1} & -e_{n-1} \\
%0 & 0 & \cdots & -e_{n-1} & d_n \end{bmatrix}
%=
%\Lambda
%\begin{bmatrix} \mathbf{x_1} &  \mathbf{x_2} & \cdots & \mathbf{x_n} \end{bmatrix}
%\end{equation}
%Taking this column by column, first we have
%\begin{equation}
%d_1 \mathbf{x_1} - e_1 \mathbf{x_2} = \Lambda \mathbf{x_1}
%\label{eq:lanc1}
%\end{equation}
%If we pre-multiply by $\mathbf{x_1^T}$, using $\mathbf{x_1^T} \mathbf{x_1}=1$ and $\mathbf{x_1^T} \mathbf{x_2}=0$ we get
%\begin{equation}
%d_1 = \mathbf{x_1^T} \Lambda \mathbf{x_1}
%\label{eq:lanc2} 
%\end{equation}
%Then rewriting Eq. \ref{eq:lanc1} as
%\begin{equation}
%e_1 \mathbf{x_2} = d_1 \mathbf{x_1} - \Lambda \mathbf{x_1} = \mathbf{\hat{x}_2}
%\label{eq:lanc3}
%\end{equation}
%The vector $\mathbf{\hat{x}_2}$ is may be calculated from $d_1$, $\mathbf{x_1}$ and $\Lambda$ and since $\mathbf{x_2}$ is a unit vector $e_1$ may be calculated from
%\begin{equation}
%e_1 = \norm{\mathbf{\hat{x}_2}}
%\label{eq:lanc4}
%\end{equation}
%and then
%\begin{equation}
%\mathbf{x_2} = \frac{\mathbf{\hat{x}_2}}{e_1}
%\label{eq:lanc5}
%\end{equation}
%This procedure of Eqs. \ref{eq:lanc1} to \ref{eq:lanc5} may be repeated for each column of the equation calculating all the $d_i$, $e_i$ and $\mathbf{x_i}$.
%
%Using this algorithm we can find the second transformation $\mathbf{z} = U \mathbf{v}$ which leads to the new system:
%\begin{equation}
%\ddot{\mathbf{z}}(t) + J \mathbf{z}(t) =   U A^{-1} \mathbf{b} u(t)
%\label{eq:jacobi1}
%\end{equation}
%\begin{equation}
%y(t) = \mathbf{c}^T  A U^T \mathbf{z}(t)
%\label{eq:jacobi2}
%\end{equation}
%Note that this transformation is only possible if Eq. \ref{eq:lambda} holds.
%
\end{frame}

\subsection{Mass Spring Reconstruction}
\begin{frame}
The final step is to reconstruct the mass and stiffness matrices $M$ and $K$.
It can be shown that $J =  M^{-\frac{1}{2}} K M^{-\frac{1}{2}}$ and the transformation $\mathbf{x} = M^{\frac{1}{2}} \mathbf{z}$ where $M$ has the form given in Eq. \ref{eq:ms3} leads to the final system:
\begin{equation}
M \ddot{\mathbf{x}}(t) + K \mathbf{x}(t) = M^{\frac{1}{2}} U A^{-1} \mathbf{b} u(t)
\label{eq:fin1}
\end{equation}
\begin{equation}
y(t) = \mathbf{c}^T  A U^T M^{\frac{1}{2}}\mathbf{x}(t)
\label{eq:fin2}
\end{equation}

The matrix $M$ is calculated as follows: We can write $K = M^{\frac{1}{2}} J M^{\frac{1}{2}}$ where $K$ and $M$ are mass and stiffness matrices of Eq. \ref{eq:ms3} which we want to calculate.
We will only consider here the case where $k_0 = k_n = 0$ and where $K$ (and $J$) are singular, corresponding to a free-free mass-spring system.
In this case one eigenvalue of the system $\lambda_1 = 0$.
The example we show later in the paper is indeed such a system.
The rows of $K$ must sum to zero. This can be written as
\begin{equation}
K \begin{bmatrix} 1 & 1 & \cdots & 1 \end{bmatrix}^T =  M^{\frac{1}{2}} J M^{\frac{1}{2}} \begin{bmatrix} 1 & 1 & \cdots & 1 \end{bmatrix}^T = \mathbf{0}
\end{equation} 
which may be rewritten as
\begin{equation}
J \begin{bmatrix} \sqrt{m_1} & \sqrt{m_2} & \cdots & \sqrt{m_n} \end{bmatrix}^T = \mathbf{0}
\end{equation}
Once a value is chosen for $m_1$ this equation may be solved row by row to calculate each $m_i$.
The values of the $k_i$ easily follow.
The correct choice for $m_1$ is shown in Eq. \ref{eq:bcxm} below.
\end{frame}


\subsection{Necessary and Sufficient Conditions for Transformation}
\begin{frame}
By comparing this system to that of Eqs. \ref{eq:ms1}-\ref{eq:ms3} we get the following equation for $\mathbf{b}$ and $\mathbf{c}$.
\begin{equation}
M^{\frac{1}{2}} U A^{-1} \mathbf{b} = M^{\frac{1}{2}} U A \mathbf{c} = \begin{bmatrix} 1 &  0 & \cdots & 0 \end{bmatrix}^T
\label{eq:bhat}
\end{equation}
which can be simplified to
\begin{equation}
A^{-1} \mathbf{b} = A \mathbf{c} = \frac{1}{m_1} U^T \begin{bmatrix} 1 &  0 & \cdots & 0 \end{bmatrix}^T
\label{eq:bc1}
\end{equation}
and then
\begin{equation}
A^{-1} \mathbf{b} = A \mathbf{c} = \frac{1}{m_1} \mathbf{x}_1
\label{eq:bc2}
\end{equation}
This can be solved to give
\begin{equation}
a_i = \sqrt{\frac{b_i}{c_i}} ,\quad m_1 = \sqrt{\frac{1}{\sum b_i c_i}} ,\quad x_{i1} = \sqrt{\frac{b_i c_i}{\sum b_i c_i}}
\label{eq:bcxm}
\end{equation}
By combining the three steps the overall transformation can be written as
\begin{equation}
P =  M^{-\frac{1}{2}} U A^{-1}
\label{eq:p}
\end{equation}
Examining Eq. \ref{eq:bcxm} we find that a second necessary and sufficient condition for $P$ to exist is
\begin{equation}
\frac{b_i}{c_i} > 0 \quad \forall i
\label{eq:bc1}
\end{equation}
that is, the sign of each $b_i$ term is the same as the corresponding $c_i$ term. 
Also note however that if
\begin{equation}
\frac{b_i}{c_i} < 0 \quad \forall i
\label{eq:bc2}
\end{equation}
then we can write down a new system by changing the signs of both $u(t)$ and $\mathbf{b}$. We then have a new system identical to the old system but where the input is $-u(t)$ and Eq. \ref{eq:bc1} is satisfied.
This condition may be summarized as: the corresponding entries in the $\mathbf{b}$ and $\mathbf{c}$ vectors must either all have the same sign or all have opposite signs.
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%-------RESULTS--------%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results}

\subsection{Segmented Rocket Model}

\begin{frame}{Segmented rocket model}
\begin{columns} %%% check alignment in beamer columns
\column{0.5\textwidth}
\centering
\input{graphics/seg3-rocket-allact-pres.tex} \\
Segmented rocket model
\column{0.5\textwidth}
\begin{itemize}
\item 3 rigid bodies, 2 torsional springs
\item 4 actuators - three lateral thruster forces $f_i$
\item gimballed engine thrust - $\delta$
\item Three outputs - attitude sensors on each segment - $\alpha_1$, $\alpha_2$ and $\alpha_3$
\end{itemize}
\end{columns}
\end{frame}

\begin{frame}{Segmented rocket model}
\begin{itemize}
\item Equations of motion:
\begin{multline}
\input{python/eq1.tex}
\end{multline}
\item Output equation:
\begin{equation}
\input{python/eq2.tex}
\end{equation}
\item Choice of 4 actuators and 3 attitude sensors
\end{itemize}
\end{frame}

\begin{frame}{Model Parameters}
\begin{columns}
\column{0.3\textwidth}
\centering
\includegraphics[height=0.75\textheight]{images/Vega.png} \\
Vega Rocket
\column{0.7\textwidth}
\begin{itemize}
\item Numerical values for model parameters representative of European \emph{Vega} rocket \footcite{Perez2006}
\item Chosen to match MOI, mass and first two vibration frequencies
\end{itemize}
\begin{table}
  \begin{center}
    \begin{tabular}{ ccc }
	\hline
           Parameter & Value & Unit \\
	\hline
      	$m$ & $5 \cdot 10^4$ & $kg$\\
      	$k$ & $6 \cdot 10^7$ & $Nm$\\
      	$I$ & $5 \cdot 10^5$ & $kg~m^2$\\
      	$h$ & $10$ & $m$\\
      	$T$ & $2.3 \cdot 10^6$ & $N$\\
    \end{tabular}
  \end{center}
\end{table}
\end{columns}

\end{frame}

\begin{frame}
Tab. \ref{tab:modelparam} presents numerical parameters for the model presented in Section \ref{sec:math-model} which are representative of the European launcher \emph{Vega} \cite{Perez2006}.
These values were substituted into the rocket equations of motion and then the system was diagonalised to have the same structure as Eqs. \ref{eq:modal1} to \ref{eq:modal3}.
\begin{multline}
\input{python/eqdiag1.tex}
\label{eq:num_rock1}
\end{multline}
\begin{equation}
\input{python/eqdiag2.tex}
\label{eq:num_rock2}
\end{equation}
\end{frame}

\subsection{Test Cases for different sensor-actuator combinations}

\begin{frame}{Example Step Response}{Test Case 1}
\begin{columns}
\column{0.25\textwidth}
text
\column{0.75\textwidth}
    \includegraphics[width=\textwidth]{graphics/rocket-trans-pres.pdf}
\end{columns}
\end{frame}

\begin{frame}{Example Step Response}{Test Case 1}
\begin{center}
    \input{graphics/testcase1.tex}
\end{center}
\end{frame}

\begin{frame}{Example Step Response}{Test Case 2}
\begin{center}
    \input{graphics/testcase3.tex}
\end{center}
\end{frame}

\begin{frame}{Example Step Response}{Test Case 3}
\begin{center}
    \input{graphics/testcase2.tex}
\end{center}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%-------SUMMARY--------%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Summary}

\begin{frame}{Summary}

mass-spring representations of a wide class of SISO systems.
force on the first mass and the output is the position of the first mass.
These are the type of systems for which WBC has been shown to work well.
The transformation is possible for a system described by Eqs. \ref{eq:modal1}-\ref{eq:modal3}, with non-negative and distinct eigenvalues and corresponding entries in the $\mathbf{b}$ and $\mathbf{c}$ vectors either all having the same sign or all having opposite signs.

It is clear that the non-uniformity of the resulting mass-spring system and the position of this non-uniformity are key in assessing the difficulty of the control problem.
From a wave based perspective large masses in the centre of the cascade lead to the trapping of waves in the outer part of the system increasing settling times.



WBC was developed with reference to cascaded mass-spring systems such as that in Fig. \ref{fig:wave-based-control}.
When designing a WBC controller for these systems the underlying wave model, which is well understood, naturally suggests the best tuning parameters for the controller.
While the technique has also been applied successfully to systems with more complex structure such as bending and slewing systems, cranes and 2-D mass-spring arrays, in these cases tuning has been carried out somewhat experimentally without reference to the underlying wave model.
This paper asserts that many of these more complicated systems have the same underlying structure as simple mass-spring cascades with actuator and sensor at one end.
An algorithm is presented for calculating these equivalent mass-spring systems.
Using these equivalent mass-spring representations allows us to quickly design and tune controllers for a much wider class of systems including multibody spacecraft models.
In addition, previously established analytical results concerning stability and robustness of WBC for mass-spring systems are now readily applicable to this wider class of systems.

Given the choices of actuators and sensors for the rocket model presented in Sec. \ref{sec:math-model} we have found that there are three configurations which allow us to calculate an equivalent mass-spring system with both actuator and sensor at one end.
The first system with actuator $\delta$ and sensor $\alpha_1$ both on the bottom segment is somewhat expected and has obvious similarities to a 3-mass, 2-spring system.
Interestingly, even though the rocket segments are identical, the ratio of the masses in the equivalent mass-spring system is [1:1.2:4.3] which is quite non-uniform with masses increasing as they get farther from the actuator and nearly equal springs.
The system with actuator $-f_3$ and sensor $\alpha_3$ is very similar with mass ratio [1:1.2:3.4] also increasing farther from the actuator and also with similar springs.
There is an obvious symmetry between these two systems.
One launches and absorbs waves at the bottom of the rocket and the other launches and absorbs at the top. 
When WBC is applied to these systems the step response of the closed-loop systems are seen to behave excellently with minimal overshoot and small settling times (Figs. \ref{fig:graphdel}, \ref{fig:graphf3}).
The final system with actuator $-f_2$ and sensor $\alpha_2$ has a mass ratio of [1:8.7:0.4] and spring ratio of [1:0.08] which is highly non-uniform.
In the step response for this system we can see that the measured variable $\alpha_2$ approaches the target and settles quickly with small oscillations around the target attitude.
However the other rocket segments continue to oscillate about the target for a long period of time.

The above phenomena can be explained from a wave perspective.
A change in mass in a non-uniform system can be considered as a change in wave impedance causing partial transmission and reflection of waves.
In the case where mass increases farther away from the actuator, some of the launched wave is reflected back at these changes in impedance.
This is not a problem however as the actuator can launch a further wave to compensate and ensure the system reaches the target.
Conversely, in the case where there is a large mass in the centre of the system (Fig. \ref{fig:graphf2}), returning waves are reflected back into the farthest part of the system and become trapped by the larger mass in the centre.
This is the reason for the prolonged oscillations in the system of Fig. \ref{fig:graphf2}.
It should be noted that this poor response is not a failing of the WBC technique but rather an indication of the difficulty of the control problem.
Any controller measuring at the first mass will have to somehow measure the motion of the smaller end mass through the large mass in the centre of the system.
Then to control that end mass the actuator must work through the intervening dynamics of the large mass in between.
It is clear form this analysis that the non-uniformity of the system plays a key role in assessing the difficulty of the control problem.
It is the position of the non-uniformity, rather than the ratio of the masses or springs that is the key determining factor in the difficulty of the problem.



A procedure has been presented for calculating equivalent cascaded mass-spring representations of a wide class of SISO systems.
In these equivalent mass-spring representations, the input is a force on the first mass and the output is the position of the first mass.
These are the type of systems for which WBC has been shown to work well.
The transformation is possible for a system described by Eqs. \ref{eq:modal1}-\ref{eq:modal3}, with non-negative and distinct eigenvalues and corresponding entries in the $\mathbf{b}$ and $\mathbf{c}$ vectors either all having the same sign or all having opposite signs.
The transformation may be formulated as an inverse eigenvalue problem for a Jacobi matrix and solved using the Lanczos algorithm.
As an example, the equations of motion were derived for a segmented multibody rocket with twelve possible actuator-sensor configurations.
Equivalent mass-spring systems were possible and were calculated for three of these configurations. 
WBC controllers were designed and tuned using the equivalent mass-spring systems.
In each case and the closed-loop step responses were plotted.

Equivalent mass-spring representations allow quick design and tuning of WBC controllers for a much wider class of systems.
Previously established analytical results concerning stability and robustness of WBC for mass-spring systems are now readily applicable to this wider class of systems.
It is clear that the non-uniformity of the resulting mass-spring system and the position of this non-uniformity are key in assessing the difficulty of the control problem.
From a wave based perspective large masses in the centre of the cascade lead to the trapping of waves in the outer part of the system increasing settling times.

This paper considered only mass spring systems where the input is a force on the first mass and the output is the position of the first mass.
A possible area for future research is to investigate equivalent systems where the input and output may be on different masses internal to the system.
There is also scope for using similar techniques to optimise actuator and sensor locations within a system.
The objective could be to make the resulting equivalent mass-spring system as close to uniform as possible.

  % Keep the summary *very short*.
  \begin{itemize}
  \item
    The \alert{first main message} of your talk in one or two lines.
  \item
    The \alert{second main message} of your talk in one or two lines.
  \item
    Perhaps a \alert{third message}, but not more than that.
  \item
    Future Work
    \begin{itemize}
    \item A possible area for future research is to investigate equivalent systems where the input and output may be on different masses internal to the system.
    \item There is also scope for using similar techniques to optimise actuator and sensor locations within a system.
    \end{itemize}
    
  \end{itemize}
\end{frame}



% All of the following is optional and typically not needed. 
\appendix
\section<presentation>*{\appendixname}
\subsection<presentation>*{For Further Reading}

\begin{frame}[allowframebreaks]
  \frametitle<presentation>{For Further Reading}
\printbibliography
\end{frame}

\end{document}
